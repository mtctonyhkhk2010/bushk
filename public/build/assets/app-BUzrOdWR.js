window.fetchEta=async(e,r,h=null,n=null,u=null,i=null,f=null)=>{let s,a={},d=[];e==="kmb"&&(s=`https://data.etabus.gov.hk/v1/transport/kmb/eta/${r}/${h}/${n}`),e==="ctb"&&(s=`https://rt.data.gov.hk//v2/transport/citybus/eta/CTB/${r}/${h}`),e==="gmb"&&(s=`https://data.etagmb.gov.hk/eta/route-stop/${u}/${r}`),e==="nlb"&&(s="https://rt.data.gov.hk/v1/transport/nlb/stop.php?action=estimatedArrivals",a={method:"POST",body:JSON.stringify({routeId:f,stopId:r,language:"zh"})});const m=await(await fetch(s,a)).json();return(e==="kmb"||e==="ctb")&&m.data.forEach(t=>{t.eta===""||t.eta===null||t.dir!==i||d.push({timestamp:Date.parse(t.eta),eta:t.eta,co:t.co,remark:t.rmk_tc})}),e==="gmb"&&m.data.forEach(t=>{i==="I"&&t.route_seq===1||i==="O"&&t.route_seq===2||t.eta.forEach(l=>{l.timestamp===""||l.timestamp===null||d.push({timestamp:Date.parse(l.timestamp),eta:l.timestamp,co:"gmb",remark:l.remarks_tc})})}),e==="nlb"&&m.estimatedArrivals.forEach(t=>{t.estimatedArrivalTime===""||t.estimatedArrivalTime===null||d.push({timestamp:Date.parse(t.estimatedArrivalTime),eta:t.estimatedArrivalTime,co:"nlb",remark:""})}),d};window.distance=(e,r,h,n)=>{if(e===h&&r===n)return 0;{let u=Math.PI*e/180,i=Math.PI*h/180,f=r-n,s=Math.PI*f/180,a=Math.sin(u)*Math.sin(i)+Math.cos(u)*Math.cos(i)*Math.cos(s);return a>1&&(a=1),a=Math.acos(a),a=a*180/Math.PI,a=a*60*1.1515,a*1.609344}};
